generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// ======================
// USER MODEL
// ======================
model User {
  id               Int             @id @default(autoincrement())
  email            String          @unique
  password         String
  name             String?
  createdAt        DateTime        @default(now())
  updatedAt        DateTime        @updatedAt
  activities       Activity[]
  carbonSummaries  CarbonSummary[]
  carbonRecords    CarbonRecord[]
}

// ======================
// RECYCLE ITEM (AI)
// ======================
model RecycleItem {
  id          Int     @id @default(autoincrement())
  imageUrl    String
  itemName    String
  category    String
  description String   @db.Text
  tutorial    String   @db.Text
  materials   String[] // Array material yang dibutuhkan
  difficulty  String   // Easy, Medium, Hard
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}

// ======================
// ACTIVITY (setiap input user per kategori)
// ======================
model Activity {
  id            Int            @id @default(autoincrement())
  user           User            @relation(fields: [userId], references: [id])
  userId         Int
  category       CategoryType    // Enum: TRANSPORT, FOOD, ENERGY
  itemName       String          // contoh: "Motor", "Daging sapi", "AC"
  inputValue     Float           // contoh: 10 (km), 2 (porsi), 4 (jam)
  emissionFactor Float           // faktor emisi
  emissionTotal  Float           // hasil perhitungan (kg COâ‚‚)
  createdAt      DateTime        @default(now())
}

// ======================
// ENUM CATEGORY TYPE
// ======================
enum CategoryType {
  TRANSPORT
  FOOD
  ENERGY
}

// ======================
// CARBON SUMMARY (ringkasan harian & mingguan)
// ======================
model CarbonSummary {
  id              Int      @id @default(autoincrement())
  userId           Int
  totalDailyCarbon Float
  totalWeeklyCarbon Float
  treesNeeded      Float
  date             DateTime @default(now())

  user             User     @relation(fields: [userId], references: [id])
}

// ======================
// CARBON RECORD (data detail per aktivitas karbon)
// ======================
model CarbonRecord {
  id             Int      @id @default(autoincrement())
  userId         Int?
  category       String
  item           String
  amount         Float
  carbonEmission Float
  createdAt      DateTime @default(now())
  updatedAt      DateTime @updatedAt

  user           User?    @relation(fields: [userId], references: [id])
}
